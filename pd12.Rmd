---
title: "Práctica dirigida 12"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 1
    theme: cosmo
    highlight: textmate
    always_allow_html: true
---

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estadística para el análisis político 1 \| Semestre 2023 - 1 <br>

------------------------------------------------------------------------

# **Regresión linea múltiple**

***Recordando lo avanzado***

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd12_diap1.png") 
```

------------------------------------------------------------------------

Para fines prácticos tenemos a continuación el siguiente flujograma el cual nos muestra los pasos que seguiremos en la presente sesión

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd12_diap2.png") 
```

# **Factores que determinan el acceso a la información en los Estados**

El acceso a la información es fundamental para el funcionamiento de cualquier Estado democrático, ya que promueve la transparencia, la responsabilidad y la participación ciudadana. Permite a los ciudadanos comprender y evaluar las acciones y decisiones de sus gobiernos, fomenta el debate público informado y ayuda a prevenir la corrupción y el abuso de poder. Además, facilita la innovación y el desarrollo al permitir el intercambio de ideas y conocimientos. En suma, el acceso a la información es una herramienta vital para garantizar el respeto de los derechos humanos, la justicia social y el desarrollo sostenible.

Para poder realizar dicho análisis se han revisado diversas fuentes de información que describiremos a continuación:

**Digital Access Index** El Índice de Acceso Digital (Digital Access Index, DAI) es un indicador utilizado para medir y evaluar el nivel de acceso a las tecnologías digitales y a Internet en un país o región. Proporciona una medida de hasta qué punto las personas y las comunidades pueden utilizar y beneficiarse de las tecnologías digitales.

El DAI es una herramienta útil para los responsables de políticas, investigadores y organizaciones para comprender el estado del acceso digital e identificar áreas que necesitan mejorar. Puede ayudar a orientar los esfuerzos para reducir la brecha digital y garantizar que todas las personas tengan igualdad de oportunidades para beneficiarse de las tecnologías digitales.

**Egov-index** El Índice de Gobierno Electrónico (e-Government Index) es una medida que evalúa el nivel de desarrollo y adopción de tecnologías de la información y la comunicación (TIC) en el sector público de un país. Este índice se utiliza para medir y comparar la capacidad de los gobiernos para proporcionar servicios en línea, promover la participación ciudadana y utilizar las TIC de manera efectiva en la gestión gubernamental.

**Democracy Index** El Índice de Democracia es un índice que mide el estado de la democracia en países de todo el mundo. Es elaborado por la Unidad de Inteligencia de The Economist (EIU), una firma independiente de investigación y análisis. El índice evalúa el funcionamiento de los procesos e instituciones democráticas en cada país en base a una serie de indicadores.

A partir de la información recolectada se ha creado una base de datos llamada Egov.

```{r,echo=FALSE, out.width="80%",fig.align="center"}
knitr::include_graphics("PD12_diccionarioEgov.png") 
```

```{r}
library(rio)
Egov=import("Egov.xlsx")
names(Egov)
```

## **Modelo 1**

```{r}
library(dplyr)
library(ggplot2)

modelo1 = lm(accesoInformacion ~participaciónDigital+Servicios_Online+Capital_Humano  +Telecommunicacion_Infrastructura+ProcesoElectoral+ Policulture +UsuariosInternet   ,data=Egov)
summary(modelo1)
```

## **Interpretamos 😎**

### **¿El modelo es válido?**

Establezcamos nuestras hipótesis:

-   H0: El modelo de regresión no es válido

-   H1: El modelo de regresión es válido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es \< 2.2e-16 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo sí es válido como modelo de predicción. Es decir, podemos decir que hay evidencia estadística suficiente para afirmar que existe una relación significativa entre el Acceso a la información y nuestras variables independientes invocadas en el modelo 1.

### **¿Qué tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cuánto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arrojó el valor de 0.9217, por lo que podemos concluir mi modelo explica aproximadamente el 97.2% (0.9217\*100) de la variabilidad en el acceso a la información (variable dependiente). En otras palabras, este valor alto de R cuadrado ajustado indica que el modelo se ajusta muy bien a los datos y hace un buen trabajo al explicar la relación entre las variables independientes y la variable dependiente. Sin embargo, el valor del R cuadrado ajustado no te dice nada sobre la significancia estadística de las variables individuales, ni sobre la causalidad. Por ello analizaremos también las variables de forma independiente en el siguiente paso.

*Recordemos que el R cuadrado puede tomar valores entre 0 y 1. Un R cuadrado de 1 indica que el modelo explica toda la variabilidad de la variable de respuesta en torno a su media. Un R cuadrado de 0 indica que el modelo no explica ninguna de la variabilidad de la variable de respuesta en torno a su media.*

### **¿Las variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Nos damos cuenta que *no todas* las variables independientes cumplen, es el caso de: participaciónDigital y Servicios_Online

### **¿Cuáles son los coeficientes de la ecuación?**

Una forma amigable de poder identificar los coeficientes es usando el siguiente código:

*No olvidar identificar el signo de cada coeficiente, este tendrá repercusión en la ecuación y su futura aplicación*

```{r}
modelo1$coefficients
```

De esa manera puedo hallar la ecuación:

$$
Y = -0.12 + \text{participaciónDigital} \times (-0.078) + \text{Servicios\_Online} \times (0.080) + \text{Capital\_Humano} \times (0.29) + \text{Telecommunicacion\_Infrastructura} \times (0.35) + \text{ProcesoElectoral} \times (0.0075) + \text{Policulture} \times (0.013) + \text{UsuariosInternet} \times (0.0015)
$$

¿Qué sucede si retiro las variables independientes que no aportan al modelo 1? Veamos un segundo modelo 👀 .

## **Modelo 2**

```{r}
library(dplyr)
library(ggplot2)

modelo2 = lm(accesoInformacion ~Capital_Humano  +Telecommunicacion_Infrastructura+ProcesoElectoral+ Policulture +UsuariosInternet   ,data=Egov)
summary(modelo2)
```

## **Interpretamos 😎**

### **¿El modelo es válido?**

Establezcamos nuestras hipótesis:

-   H0: El modelo de regresión no es válido

-   H1: El modelo de regresión es válido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es \< 2.2e-16 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo sí es válido como modelo de predicción. Es decir, podemos decir que hay evidencia estadística suficiente para afirmar que existe una relación significativa entre el Acceso a la información y nuestras variables independientes invocadas en el modelo 2.

### **¿Qué tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cuánto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arrojó el valor de 0.9225, por lo que podemos concluir mi modelo explica aproximadamente el 97.25% (0.9225\*100) de la variabilidad en el acceso a la información (variable dependiente). En otras palabras, este valor alto de R cuadrado ajustado indica que el modelo se ajusta muy bien a los datos y hace un buen trabajo al explicar la relación entre las variables independientes y la variable dependiente. Sin embargo, el valor del R cuadrado ajustado no te dice nada sobre la significancia estadística de las variables individuales, ni sobre la causalidad. Por ello analizaremos también las variables de forma independiente en el siguiente paso.

### **¿Las variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Esta vez *todas* las variables independientes aportan al modelo.

### **¿Cuáles son los coeficientes de la ecuación?**

Una forma amigable de poder identificar los coeficientes es usando el siguiente código:

*No olvidar identificar el signo de cada coeficiente, este tendrá repercusión en la ecuación y su futura aplicación*

```{r}
modelo2$coefficients
```

De esa manera puedo hallar la ecuación:

$$
Y = -0.12 + \text{Capital\_Humano} \times (0.288) + \text{Telecommunicacion\_Infrastructura} \times (0.35) + \text{ProcesoElectoral} \times (0.00758) + \text{Policulture} \times (0.0145) + \text{UsuariosInternet} \times (0.0016)
$$

-   ¿Qué variable aporta más al modelo?: Telecommunicacion_Infrastructura
-   ¿Mi modelo ha mejorado?

Sí, mientras que el modelo 1 explicaba un 92.17% y el modelo 2 92.25%. A pesar de que mi modelo 1 tiene un rango de explicación alto, con el modelo 2 se ha podido demostrar que el modelo puede mejorar (así la mejora. ha haya sido sustancial).

# **Qué factores determinan la calidad de sueño del personal de salud en pandemia**

La pandemia de COVID-19 ha tenido una repercusión significativa en el personal de salud en todo el mundo. Los trabajadores de la salud han estado en la primera línea de batalla, enfrentando desafíos sin precedentes y sacrificándose para cuidar de los enfermos. Han estado expuestos a un mayor riesgo de infección debido a su constante contacto con pacientes contagiados, lo que ha llevado a un aumento alarmante de casos de COVID-19 entre el personal sanitario. Además de los riesgos físicos, el personal de salud ha enfrentado una carga emocional y psicológica abrumadora. Entre ellas una de las principales preocupaciones ha sido la calidad del sueño del personal de salud debido a que puede repercutir directamente en la calidad de atención de los pacientes. Esta información es valiosa para tomar acciones al respecto, como por ejemplo un aumento del personal de salud en las instituciones debido a la carga de la pandemia.

-   Q1: Edad
-   Q2: Género
-   Q7: ¿Se encentra en la primera línea de atención del Covid-19?
-   Q8: ¿Trabaja desde casa?
-   Q11: ¿Tiene niños en casa?
-   Q13: ¿Cuantas horas ha dormido en promedio la semana pasada?

```{r}
library(rio)
Covid=import("Covid_pd12.xlsx")
names(Covid)
```

```{r}
str(Covid)
```

```{r}
str(Covid)
```

Reviso las variables dicotómicas Q2,Q7,Q8 y Q11

```{r}
table(Covid$Q2)
table(Covid$Q7)
table(Covid$Q8)
table(Covid$Q11)
```

```{r}

Covid$Q2= factor(ifelse(Covid$Q2=="Male",1,0))
Covid$Q7= factor(ifelse(Covid$Q7=="Yes",1,0))
Covid$Q8= factor(ifelse(Covid$Q8=="Yes",1,0))
Covid$Q11= factor(ifelse(Covid$Q11=="Yes",1,0))
str(Covid)
```

```{r}
Covid$Q1= as.numeric(Covid$Q1)
Covid$Q13= as.numeric(Covid$Q13)
```

```{r}
Covid <- Covid[complete.cases(Covid), ]
```

## **Modelo 3**

Hacemos uso de todas las variables de la base de datos. Veamos los resultados.

```{r}
library(dplyr)
library(ggplot2)

modelo3 = lm(Q13 ~Q1+Q2+Q7+Q8+Q11  ,data=Covid)
summary(modelo3)
```

## **Interpretamos 😎**

### **¿El modelo es válido?**

Establezcamos nuestras hipótesis:

-   H0: El modelo de regresión no es válido

-   H1: El modelo de regresión es válido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es 2.224e-08 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo sí es válido como modelo de predicción. Es decir, podemos decir que hay evidencia estadística suficiente para afirmar que existe una relación significativa entre el el promedio de horas de sueño y las variables independientes invocadas en el modelo 3.

### **¿Qué tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cuánto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arrojó el valor de 0.08799 , por lo que podemos concluir mi modelo explica aproximadamente el 8.79% de la variabilidad en el promedio de las horas de sueño del personal de salud (variable dependiente). En otras palabras, este valor alto de R cuadrado ajustado indica que el modelo no se ajusta adecuadamente a los datos. Este resultado es bajo.

### **¿Las variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Esta vez las variables que **sí aportan** al modelo son: Q7 y Q11

### **¿Cuáles son los coeficientes de la ecuación?**

Una forma amigable de poder identificar los coeficientes es usando el siguiente código:

*No olvidar identificar el signo de cada coeficiente, este tendrá repercusión en la ecuación y su futura aplicación*

```{r}
modelo3$coefficients
```

De esa manera puedo hallar la ecuación:

$$
Y = 7.35 + \text{Q1} \times (-0.0053) + \text{Q2} \times (0.20) + \text{Q7} \times (-0.81) + \text{Q8} \times (0.19) + \text{Q11} \times (-0.47)
$$ **¿Qué sucede si retiramos aquellas variables que no aportan al modelo?** Hagamos un siguiente modelo

## **Modelo 4**

```{r}
library(dplyr)
library(ggplot2)

modelo4 = lm(Q13 ~Q7+Q11 ,data=Covid)
summary(modelo4)
```

## **Interpretamos 😎**

### **¿El modelo es válido?**

Establezcamos nuestras hipótesis:

-   H0: El modelo de regresión no es válido

-   H1: El modelo de regresión es válido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es 1.367e-09 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo sí es válido como modelo de predicción. Es decir, podemos decir que hay evidencia estadística suficiente para afirmar que existe una relación significativa entre el Promedio de horas de sueño y las variables independientes invocadas en el modelo 4.

### **¿Qué tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cuánto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arrojó el valor de 0.08711 , por lo que podemos concluir mi modelo explica aproximadamente el 8.71% de la variabilidad en el promedio de las horas de sueño del personal de salud (variable dependiente). En otras palabras, este valor alto de R cuadrado ajustado indica que el modelo no se ajusta adecuadamente a los datos. Este resultado es bajo. A pesar de ello, dado que el R cuadrado ajustado no nos dice nada sobre el aporte de cada variable independiente, hay que realizar el siguiente paso.

### **¿Las variables aportan al modelo?** 🤔

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Esta vez todas las variables *aportan* al modelo.

### **¿Cuáles son los coeficientes de la ecuación?**

Una forma amigable de poder identificar los coeficientes es usando el siguiente código:

*No olvidar identificar el signo de cada coeficiente, este tendrá repercusión en la ecuación y su futura aplicación*

```{r}
modelo4$coefficients
```

De esa manera puedo hallar la ecuación:

$$
Y = 7.27  + \text{Q7} \times (-0.88) +  \text{Q11} \times (-0.458)
$$ **¿Qué variable aporta más al modelo?**

Ojo, que no debemos de olvidar identificar el signo de las variables, por lo cual las dos independientes son negativas, es decir se trata de una relación indirecta.

Por otro lado, y en comparación al modelo 3, no podemos identificar un R cuadrado ajustado muy diferente entre los modelos (3 y 4); sin embargo, existen puntos a considerar como por ejemplo la revisión de variables que sí aporten al modelo, ya que en este último caso (modelo 4) todas las variables sí aportan al modelo. Esto probaría que se trata de una mejor elección de variables a pesar de tener un R cuadrado ajustado un poco menor al modelo 3. 👩‍🔬
