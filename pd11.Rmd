---
title: "Pr√°ctica dirigida 11"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 1
    theme: cosmo
    highlight: textmate
    always_allow_html: yes
  pdf_document:
    toc: yes
    toc_depth: '1'
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

# **Regresi√≥n linea m√∫ltiple**

Hasta el momento, nos hemos encontrado en el campo del an√°lisis bivariado. Sin embargo, en el mundo social, dif√≠cilmente se pueden explicar los fen√≥menos de inter√©s con una sola variable. Incluso si nos interesa evaluar el efecto de un a variable en espec√≠fico sobre un fen√≥meno de estudio, hay muchos otros factores que podr√≠an influir en aquello que nos interesa explorar. Por ello, necesitamos recurrir al **an√°lisis multivariado** y conocer el concepto de **control estad√≠stico**. 

El control estad√≠stico nos permite ‚Äúeliminar‚Äù explicaciones alternativas, en tanto se aisla el efecto de otras variables. La idea es:

* Evaluar si la asociaci√≥n entre X - Y permanece si se remueve el efecto de otra variable, es decir, si se controla por una tercera variable.

* Se analiza la relaci√≥n entre X - Y para valores similares o iguales de una variable Z. De esta manera se elimina la influencia de Z en la relaci√≥n entre X - Y. Es un paso en el establecimiento de X -> Y.

* Si la relaci√≥n entre X - Y desaparece cuando se controla por Z, se dice que la relaci√≥n era esp√∫rea.

Sobre la regresi√≥n lineal m√∫ltiple: 

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd12_diap1.png") 
```

------------------------------------------------------------------------

Seguiremos los siguientes pasos para el an√°lisis: 

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd12_diap2.png") 
```

# Aplicaci√≥n pr√°ctica

## **Factores que determinan el acceso a la informaci√≥n en los Estados**

El acceso a la informaci√≥n es fundamental para el funcionamiento de cualquier Estado democr√°tico, ya que promueve la transparencia, la responsabilidad y la participaci√≥n ciudadana. 

Para poder realizar el an√°lisis se han revisado las siguientes fuentes:

**Digital Access Index** El √çndice de Acceso Digital es utilizado para medir y evaluar el nivel de acceso a las tecnolog√≠as digitales y a internet. Proporciona una medida de hasta qu√© punto las personas y las comunidades pueden utilizar y beneficiarse de las tecnolog√≠as digitales.

**Egov-index** El √çndice de Gobierno Electr√≥nico es una medida que eval√∫a el nivel de desarrollo y adopci√≥n de tecnolog√≠as de la informaci√≥n y la comunicaci√≥n (TIC) en el sector p√∫blico. Este √≠ndice se utiliza para medir la capacidad de los gobiernos para proporcionar servicios en l√≠nea, promover la participaci√≥n ciudadana y utilizar las TIC de manera efectiva en la gesti√≥n gubernamental.

**Democracy Index** El √çndice de Democracia es un √≠ndice que mide el estado de la democracia en pa√≠ses de todo el mundo. Es elaborado por The Economist (EIU) y eval√∫a el funcionamiento de los procesos e instituciones democr√°ticas.

A partir de la informaci√≥n recolectada se ha creado una base de datos llamada Egov.

```{r,echo=FALSE, out.width="80%",fig.align="center"}
knitr::include_graphics("PD12_diccionarioEgov.png") 
```

```{r}
library(rio)
Egov=import("EGov.xlsx")
names(Egov)
```

**No olviden el an√°lisis descriptivo antes de hacer los modelos.**

## **Modelo 1**

```{r}
library(tidyverse)

modelo1 = lm(accesoInformacion ~participaci√≥nDigital+Servicios_Online+Capital_Humano  +Telecommunicacion_Infrastructura+ProcesoElectoral+ Policulture +UsuariosInternet ,data=Egov)
summary(modelo1)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es \< 2.2e-16 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n. 

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared, por ser un modelo lineal m√∫ltiple).

En nuestro modelo, este arroj√≥ el valor de 0.9217, por lo que podemos concluir que el modelo explica aproximadamente el 92.2% (0.9217\*100) de la variabilidad en el acceso a la informaci√≥n (variable dependiente). En otras palabras, este valor alto de R cuadrado ajustado indica que el modelo se ajusta muy bien a los datos y hace un buen trabajo al explicar la relaci√≥n entre las variables independientes y la variable dependiente. Sin embargo, el valor del R cuadrado ajustado no te dice nada sobre la significancia estad√≠stica de las variables individuales, ni sobre la causalidad. Por ello analizaremos tambi√©n las variables de forma independiente en el siguiente paso.

*Recordemos que el R cuadrado puede tomar valores entre 0 y 1. Un R cuadrado de 1 indica que el modelo explica toda la variabilidad de la variable Y. Un R cuadrado de 0 indica que el modelo no explica nada de la variabilidad de la variable Y.*

### **¬øLas variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Nos damos cuenta que *no todas* las variables independientes tienen un p-value \<0.05, es el caso de: participaci√≥nDigital y Servicios_Online

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

Podemos obtener extraer los coeficientes del modelo: 

*No olvidar identificar el signo de cada coeficiente, este tendr√° repercusi√≥n en la ecuaci√≥n y su futura aplicaci√≥n*

```{r}
modelo1$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = -0.12 + \text{participaci√≥nDigital} \times (-0.078) + \text{Servicios\_Online} \times (0.080) + \text{Capital\_Humano} \times (0.29) + \text{Telecommunicacion\_Infrastructura} \times (0.35) + \text{ProcesoElectoral} \times (0.0075) + \text{Policulture} \times (0.013) + \text{UsuariosInternet} \times (0.0015)
$$

¬øQu√© sucede si retiro las variables independientes que no aportan al modelo 1? Veamos un segundo modelo üëÄ .

## **Modelo 2**

```{r}
library(dplyr)
library(ggplot2)

modelo2 = lm(accesoInformacion ~Capital_Humano  +Telecommunicacion_Infrastructura+ProcesoElectoral+ Policulture +UsuariosInternet   ,data=Egov)
summary(modelo2)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es \< 2.2e-16 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n. 

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arroj√≥ el valor de 0.9225, por lo que podemos concluir mi modelo explica aproximadamente el 92.25% (0.9225\*100) de la variabilidad en el acceso a la informaci√≥n (variable dependiente). E

### **¬øLas variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   *Todas* las variables independientes aportan al modelo.

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

```{r}
modelo2$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = -0.12 + \text{Capital\_Humano} \times (0.288) + \text{Telecommunicacion\_Infrastructura} \times (0.35) + \text{ProcesoElectoral} \times (0.00758) + \text{Policulture} \times (0.0145) + \text{UsuariosInternet} \times (0.0016)
$$

Mi modelo ha mejorado?

Ligeramente, mientras que el modelo 1 explicaba un 92.17% y el modelo 2 92.25%. A pesar de que mi modelo 1 tiene un rango de explicaci√≥n alto, con el modelo 2 se ha podido demostrar que el modelo puede mejorar (as√≠ la mejora no ha haya sido sustancial).

## **Qu√© factores determinan la calidad de sue√±o del personal de salud en pandemia**

La pandemia de COVID-19 tuvo una repercusi√≥n significativa en el personal de salud en todo el mundo. Los trabajadores de la salud estuvieron en la primera l√≠nea de batalla, enfrentando desaf√≠os sin precedentes. Adem√°s de los riesgos f√≠sicos, el personal de salud enfrent√≥ una carga emocional y psicol√≥gica abrumadora. Una de las principales preocupaciones era la calidad del sue√±o del personal de salud, pues pod√≠a repercutir directamente en la calidad de atenci√≥n de los pacientes. 

-   Q1: Edad
-   Q2: G√©nero
-   Q7: ¬øSe encentra en la primera l√≠nea de atenci√≥n del Covid-19?
-   Q8: ¬øTrabaja desde casa?
-   Q11: ¬øTiene ni√±os en casa?
-   Q13: ¬øCuantas horas ha dormido en promedio la semana pasada?

```{r}
Covid=import("COVID_pd12.xlsx")
names(Covid)
```

```{r}
str(Covid)
```

```{r}
str(Covid)
```

Reviso las variables dicot√≥micas Q2,Q7,Q8 y Q11

```{r}
table(Covid$Q2)
table(Covid$Q7)
table(Covid$Q8)
table(Covid$Q11)
```

```{r}
Covid$Q2= factor(ifelse(Covid$Q2=="Male",1,0))
Covid$Q7= factor(ifelse(Covid$Q7=="Yes",1,0))
Covid$Q8= factor(ifelse(Covid$Q8=="Yes",1,0))
Covid$Q11= factor(ifelse(Covid$Q11=="Yes",1,0))
str(Covid)
```

```{r}
Covid$Q1= as.numeric(Covid$Q1)
Covid$Q13= as.numeric(Covid$Q13)
```

```{r}
Covid = Covid[complete.cases(Covid), ]
```

## **Modelo 3**

Hacemos uso de todas las variables de la base de datos. Veamos los resultados.

```{r}
modelo3 = lm(Q13 ~Q1+Q2+Q7+Q8+Q11  ,data=Covid)
summary(modelo3)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es 2.224e-08 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n.

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arroj√≥ el valor de 0.08799 , por lo que podemos concluir el modelo explica aproximadamente el 8.79% de la variabilidad en el promedio de las horas de sue√±o del personal de salud (variable dependiente).

### **¬øLas variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Esta vez las variables que **s√≠ aportan** al modelo son: Q7 y Q11

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

Coeficientes:

```{r}
modelo3$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = 7.35 + \text{Q1} \times (-0.0053) + \text{Q2} \times (0.20) + \text{Q7} \times (-0.81) + \text{Q8} \times (0.19) + \text{Q11} \times (-0.47)
$$ **¬øQu√© sucede si retiramos aquellas variables que no aportan al modelo?** Hagamos un siguiente modelo

## **Modelo 4**

```{r}
modelo4 = lm(Q13 ~Q7+Q11 ,data=Covid)
summary(modelo4)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es 1.367e-09 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n. 

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared).

En nuestro modelo, este arroj√≥ el valor de 0.08711 , por lo que podemos concluir mi modelo explica aproximadamente el 8.71% de la variabilidad en el promedio de las horas de sue√±o del personal de salud (variable dependiente). 

### **¬øLas variables aportan al modelo?** ü§î

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Todas las variables *aportan* al modelo.

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

```{r}
modelo4$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = 7.27  + \text{Q7} \times (-0.88) +  \text{Q11} \times (-0.458)
$$ **¬øQu√© variable aporta m√°s al modelo?**

Mi modelo ha mejorado?
