---
title: "Pr√°ctica dirigida 1"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 3
    theme: cosmo
    highlight: textmate
    always_allow_html: true
---

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estad√≠stica para el an√°lisis pol√≠tico 1 \| Semestre 2024 - 1 <br>

------------------------------------------------------------------------

## **Introducci√≥n a R**

<a id='beginning'></a>

<a id='part1'></a>

# **1. ¬øQu√© es R?**

R es un lenguaje de programaci√≥n y un entorno de software libre y de c√≥digo abierto utilizado para an√°lisis estad√≠stico y visualizaci√≥n de datos. Fue desarrollado por Ross Ihaka y Robert Gentleman en la Universidad de Auckland, Nueva Zelanda, en 1993. Desde entonces, ha sido ampliamente adoptado por la comunidad cient√≠fica y empresarial como una herramienta esencial para el an√°lisis y la visualizaci√≥n de datos.

R cuenta con una amplia variedad de paquetes y bibliotecas que permiten el an√°lisis estad√≠stico, la miner√≠a de datos, el aprendizaje autom√°tico, la visualizaci√≥n de datos y la generaci√≥n de informes. Adem√°s, su sintaxis es relativamente sencilla, lo que facilita su aprendizaje y uso para personas con distintos niveles de experiencia en programaci√≥n, lo cual ha significado su uso en diversos rubros.

```{r echo=FALSE}
library(vembedr)

embed_youtube("ZCQHm63xc4s")
```

------------------------------------------------------------------------

<a id='part2'></a>

# **2. ¬øQu√© podemos hacer con R?**

![](QphacerR1.png)

![](QphacerR2.png)

![](QphacerR3.png)

![](QphacerR4.png)

------------------------------------------------------------------------

<a id='part3'></a>

# **3. Conceptos b√°sicos para programar en R**

Instalar [R](http://www.r-project.org)

Instalar [RStudio](https://posit.co/downloads/)

### Usando R

![](PrograR.png)

#### **3.1. Configurar el directorio de trabajo**

R funciona como un entorno temporal de trabajo, lo que quiere decir que el usuario va agregando datos y objetos. Sin embargo, si los an√°lisis no son guardados se deber√°n repetir las instrucciones para obtener otra vez el resultado. Por esta raz√≥n, es preciso configurar una carpeta predeterminada en nuestro ordenador, donde el programa buscar√° los archivos a ejecutar y guardar√° los archivos a conservar con cambios.

Para ver nuestro lugar de trabajo actual escribimos el siguiente comando (escriba el c√≥digo en la consola, ya que si lo ejecuta desde este Rmd, obtendr√° el lugar donde se encuentra este archivo):

```{r}
getwd() #para saber en qu√© carpeta est√° el archivo
```

Si queremos cambiar de directorio de trabajo, nos dirigirnos al men√∫ **"Session" \> "Set Working Directory" \> "Choose Directory"**. Esto abrir√° una ventana emergente, donde buscaremos la carpeta en la cual vamos a trabajar, la ubicamos y seleccionamos "Open". Para verificar el cambio volvemos a digitar la funci√≥n **"getwd()"** en la consola.

#### **3.2. Sintaxis y objetos en R**

El uso de R es bastante intuitivo y sigue un patr√≥n l√≥gico. Est√° compuesto de c√≥digos y la combinaci√≥n de estos c√≥digos genera una sintaxis. Asimismo, R guarda la informaci√≥n de nuestras observaciones y variables a trav√©s de objetos.

En un sentido global, la estructura general de una sintaxis puede resumirse como sigue: a un objeto dado se le asigna el resultado de una funci√≥n, que a su vez se ejecuta sobre un conjunto de datos especificado, con una serie de configuraciones particulares. Veamos el siguiente ejemplo ficticio.

![](Sintax.png)

Si se lee de izquierda a derecha, la l√≠nea de comando puede explicarse como sigue:

-   Primero se indica un objeto a crear, con el nombre que ustedes definan.

-   Luego se indica el asignador, que expresa que todo lo que est√© a la derecha de la flecha se guardar√° en el objeto creado a la izquierda. El asignador puede ser "\<-" o tambi√©n "=", para motivos del curso usaremos este √∫ltimo.

-   Luego viene la funci√≥n que en este caso permite leer archivos tipo Microsoft Excel. R trabaja con funciones que est√°n dentro de "paquetes" que la comunidad va desarrollando. Podemos hacer nuestras operaciones con diversas funciones, y no hay una sola forma de hacerlo. Si se trata de funciones que no est√°n predeterminadas en R, debemos instalar el paquete que las contiene con el comando "install.packages()", y antes de ejecutarla debemos abrir la libreria con el comando "library()"

-   Luego de la funci√≥n, se abre un par√©ntesis que contiene los argumentos: instrucciones que especifican ciertos detalles de lo que queramos que la funci√≥n realice. Los argumentos pueden escribirse de distintas maneras y va a depender de lo que queramos hacer. En nuestro ejemplo: El primer argumento indica la informaci√≥n a leer, en este caso indica un archivo de tipo Excel (extensi√≥n xlsx). El segundo argumento indica la hoja del archivo a leer. El tercer argumento indica qu√© columnas se leer√°n de forma espec√≠fica (en este caso, las primeras diez).

**Hagamos un ejemplo:**

Vamos a abrir un archivo en R, utilizando la funci√≥n "import" del paquete "rio", el cual es un paquete vers√°til que nos permite importar datos de diversas extensiones (dta, sav, csv, xls, etc.)

Antes que todo, debemos instalar el paquete escribiendo en la consola: `install.packages("rio")`

```{r}
library(rio) #Convocamos el paquete   
data=import("DemocracyIndex2022.xlsx") #Utilizamos la funci√≥n import (importar) que crear√° un objeto  que contenga la base de datos del archivo "DemocracyIndex2022.xlsx" la cual hemos descargado. 

#Podemos verificar la creaci√≥n del objeto en el environment (ventana derecha superior)

class(data) #si quieren saber que clase de objeto es el que has creado, utilizamos la funci√≥n "class" y entre par√©ntesis colocamos el nombre del objeto. Ver√°n que se trata de un "data frame", es el tipo de objeto en R para las bases de datos.
```

##### ¬øQu√© otro tipo de objetos existen? ü§î

#### **3.3. Tipos de objetos en R**

Una parte clave para iniciar el manejo del programa es identificar los diversos objetos que podemos crear, manipular y utilizar. Para la definici√≥n de objetos en R ser√° necesario previamente tener claridad te√≥rica sobre lo que es una variable categ√≥rica nominal, categ√≥rica ordinal, num√©rica discreta y num√©rica continua.

Para los fines de este curso se contemplar√°n las siguientes objetos:

+------------------------+----------------------------------------------------------------------------------------------------------------------------------------+
| Tipo                   | Descripci√≥n                                                                                                                            |
+========================+========================================================================================================================================+
| **Vector num√©rico**    | Vector conformado por la concatenaci√≥n de n√∫meros, puede representar variables num√©ricas continuas o discretas. Ej: 1.5 , 2.7 , 3.1    |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------+
| **Vector de factores** | Vector que sirve para representar variables categ√≥ricas.                                                                               |
|                        |                                                                                                                                        |
|                        | Pudiendo ser factores nominales u ordinales. Ej: "costa", "sierra", "selva"                                                            |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------+
| **Data frames**        | Son hojas de datos, estructuras similares a una matriz; sin embargo, a diferencia de estas pueden almacenar objetos de distintos tipo. |
|                        |                                                                                                                                        |
|                        | **Generalmente nuestras bases de datos son de este tipo** (como una hoja de Excel que tiene variables num√©ricas, categ√≥ricas, etc).    |
+------------------------+----------------------------------------------------------------------------------------------------------------------------------------+

Los **vectores num√©ricos** se crean a trav√©s de la funci√≥n ***concatenar*** **`c()`**. Vamos a crear un vector que contenga los montos en millones de soles del presupuesto del Estado asignado a las 5 prioridades para el 2021

```{r}
Presupuesto_millones=c(9879, 33132, 20991, 690, 5392) #creamos el vector (verifiquemos en el environment)
Presupuesto_millones #invocamos el vector para visualizar su contenido
```

Un **factor** nos permite representar una variable categ√≥rica. Se crean a trav√©s de la funci√≥n **"factor()"**, pero antes se crea como vector pues almacena las categor√≠as en la forma de un vector con n√∫meros discretos integrales (1,2,3,4,etc.), que son c√≥digos de los valores de la variable y otro vector de caracteres interno que contiene las etiquetas de esos c√≥digos. Creemos un factor con los nombres de las prioridades del presupuesto para el 2021:

```{r}
Prioridad = c(1,2,3,4,5) #primero creamos un vector
Prioridad = factor(Prioridad, levels = c(1:5), labels = c("reactivaci√≥n", "educaci√≥n","salud","mujer","pobreza")) #Lo convertimos en factor. Ojo con los argumentos.
Prioridad #visualizamos su contenido
```

Tambi√©n podemos crear un **factor ordenado** para almacenar informaci√≥n de una variable categ√≥rica ordinal. Es casi la misma ruta, solo que a√±adiremos una funci√≥n m√°s para convertir el factor en ordinal. Creemos un factor ordinal ficticio que contenga el nivel de ejecuci√≥n que el Estado ha mostrado en las categor√≠as presupuestales correspondientes a las prioridades, donde *1=Mala, 2=Intermedia y 3= Buena.*

```{r}
Ejecucion=c(3,2,2,1,2) #creamos un vector num√©rico que registra los datos
Ejecucion=factor(Ejecucion) #Lo convertimos en factor
levels(Ejecucion)=c("Mala","Intermedia","Buena") #asignamos los niveles al factor
Ejecucion=ordered(Ejecucion) #indicamos que se trata de un factor ordinal (ordered)
Ejecucion #Visualizamos
```

Finalmente, los **data frames** nos permite almacenar un conjunto de datos, es decir una base de datos (bd) que tiene filas y columnas. Creemos la base de datos "PP2024" que contenga todos los objetos que hemos creado:

```{r}
PP2024 = data.frame(Prioridad,Presupuesto_millones,Ejecucion)
PP2024 # Visualice la base de datos
str(PP2024) # Visualice la estructura de la BD
names(PP2024) #Visualice los nombres de las variables de la BD
```

Cuando queramos invocar una variable espec√≠fica de una base de datos utilizaremos **`$`**, entre la base de datos y la variable que queremos invocar.

```{r}
PP2024$Prioridad #invocamos la variable prioridad de la base de datos
class(PP2024$Ejecucion) #vemos de que clase es la variable ejecuci√≥n de la data frame
```

------------------------------------------------------------------------

<a id='part4'></a>

# **4. An√°lisis descriptivo en R**

<style>
.custom-text {
  color: #00688B;
  font-family: Helvetica, sans-serif;
  text-align: center;
  font-weight: bold;
  font-size: 22px;
}
</style>

<div class="custom-text">
¬øCu√°l es el estado de la democracia en el mundo?
</div>

insertar foto de la caratula del informe 22

A√ëADIR BREVE DESCRIPCI√ìN DE LA BD, explicar su composisci√≥n y link de informe final

EDITAR: Para ello, nos planteamos la siguiente pregunta de investigaci√≥n, que nos guiar√° durante toda la sesi√≥n de hoy:

**¬°Manos a la obra!**

Importemos nuestra base de datos.

```{r, results="hide"}
library(rio)    
data=import("DemocracyIndex2022.xlsx") 
```

Es necesario saber el tipo de variable que vamos a trabajar. Por ello, exploramos las variables que tiene nuestra base de datos:

-   **chr, factor** -\> variable nominal
-   **ordered factor** -\> variable ordinal
-   **num, int** -\> variable num√©rica

```{r}
names(data)
str(data)
```

El contenido de cada variable lo podemos observar en el siguiente **diccionario de datos**:

-   **Pais**: nombre del pais

-   **Puntaje**: puntaje promedio del pa√≠s.

-   **Rank**: puesto del pa√≠s en el indice por puntaje promedio.

-   **Change_rank_previous_year**: comparaci√≥n de puesto actual respecto del a√±o anterior.

-   **Electoral_process_pluralism**: Puntaje de medici√≥n de pluralismo pol√≠tico-electoral.

-   **Functioning_government**: Puntaje de medici√≥n del funcionamiento del gobierno.

-   **Political_participation**: puntaje de medici√≥n de participaci√≥n pol√≠tica.

-   **Political_culture**: puntaje de medici√≥n de la cultura pol√≠tica.

-   **Civil_liberties**: puntaje en la medici√≥n de libertades civiles.

-   **Categor√≠as**: tipo de r√©gimen.

-   **Continente**: regi√≥n a la que pertenece el pa√≠s analizado.

## **4.1. ¬øCu√°l es la distribuci√≥n de pa√≠ses por r√©gimen?**

Siempre antes de comenzar a realizar nuestro an√°lisis, debemos identificar la estructura de las variables y verificar que est√©n bien *configuradas*. Es decir que la escala de la variable coincida con el objeto en R.

Por ejemplo, debemos asegurarnos que una variable categ√≥rica no est√© configurada como num√©rica en R, y viceversa.

**Variable "Categor√≠as":**

Queremos saber el tipo de r√©gimen de cada pa√≠s observado. Para ello, realizamos el an√°lisis de la variable en cuesti√≥n `Categor√≠as`

```{r}
class(data$Categor√≠as) 

library(tidyverse)
data %>%
 group_by(Categor√≠as) %>%
  summarize(Freq=n())
```

Se observa que, de los pa√≠ses analizados en el √≠ndice de la democtracia, 59 pa√≠ses son coniderados como **Autoritarismo**, 36 como **Reg√≠menes h√≠bridos**, 48 como **Democracia imperfecta** y solo 24 como **Democracia Plena**.

Creemos un gr√°fico de barras para visualizar mejor los pa√≠ses por tipo de r√©gimen.

```{r}
para_graficoReg=data %>%
 group_by(Categor√≠as) %>%
  summarize(Freq=n())#tabla de frecuencias

library(ggplot2)
ggplot(para_graficoReg, aes(x=Categor√≠as, y=Freq, fill=Categor√≠as)) + 
geom_bar(stat = "identity")
```

Adaptemos el dise√±o del gr√°fico :)

```{r}
library(ggplot2)
ggplot(para_graficoReg, aes(reorder(x=Categor√≠as,-Freq), y=Freq, fill=Categor√≠as)) + 
geom_bar(stat = "identity")+
  
  ggtitle("Distribuci√≥n de pa√≠ses por tipo de r√©gimen") +
  xlab("Tipo de r√©gimen") + ylab("Frecuencia")+
  geom_text(aes(label=round(Freq,1)), vjust=1.30, color="black", size=3)+
  scale_fill_brewer(name="Tipo de R√©gimen",palette="Pastel1")+
  theme(panel.background=element_rect(fill = "white", colour = "white"))
```

Las dem√°s variables son num√©ricas y est√°n configuradas como vectores num√©ricos de n√∫meros enteros (integer), por lo cual lo dejamos as√≠ üò∏.

## **4.2 ¬øCu√°l es la distribuci√≥n de pa√≠ses por puntaje?**

Entonces, una vez configurados adecuadamente nuestros **objetos**, pidamos los estad√≠sticos de tendencia central para nuestras variables de inter√©s.

Antes instalamos los paquetes que utilizaremos

-   **`install.packages("DescTools")`** para pedir los estad√≠sticos de tendencia central

| ¬øCu√°l es el promedio del puntaje de todos los pa√≠ses analizados?

Para ello, usamos el comando `mean` que significa "media o promedio".

```{r}
library(DescTools)
library(tidyverse)

data %>% summarise(media = mean(Puntaje)) #este comando nos permitir√° calcular la media. Consejo: leer este comando de derecha a izquierda
```

Este resultado quiere decir que el **puntaje promedio** de todos los pa√≠ses analizados es de 5.29 puntos.

En segundo lugar, calculamos la mediana de los puntajes. Esta medida es m√°s robusta que la media, pues resiste valores extremos.

```{r}
library(DescTools)
data %>% summarise(mediana = median(Puntaje)) #calcular la mediana. Al igual que con la media, se sugiere leer el comando de derecha a izquierda.
```

Esto quiere decir que, hasta la mitad de pa√≠ses analizados tienen una puntuaci√≥n de hasta 5.54 puntos.

**Grafiquemos** üé®

Como la variable `Puntaje` es num√©rica, esta vez pediremos un **histograma**.

```{r}
names(data)
```

```{r}
library(ggplot2) #no olvidar llamar al paquete
data %>%
ggplot(aes(x=Puntaje)) + 
geom_histogram() 
```

Si lo queremos personalizar :)

```{r}

data %>%
  ggplot(aes(x = Puntaje)) + 
  geom_histogram(color = "blue", fill = "#90EE90", bins = 30) +
  geom_text(stat = 'bin', aes(y = stat(count), label = stat(count)), vjust = -0.5, size = 3, color = "black") +
  ggtitle("Puntaje promedio por pa√≠s") +
  
  scale_y_continuous(breaks = seq(0, 12, by = 2), labels = seq(0, 12, by = 2)) +
  expand_limits(y = 12) +
  geom_vline(xintercept =  mean(data$Puntaje, na.rm = TRUE), color = "red", linetype = "dashed", size = 1) + # L√≠nea de la media
  geom_vline(xintercept = median(data$Puntaje, na.rm = TRUE), color = "blue", linetype = "dashed", size = 1) + # L√≠nea de la mediana
  theme_minimal()

 
```

El histograma muestra una **distribuci√≥n asim√©trica sesgada con ligero sesgo negativo o a la izquierda**. Esto quiere decir que existe una concentraci√≥n de datos hacia la derecha.

Tambi√©n podemos dividir las medias por grupo. Para ello, usamos el comando "group_by".

```{r}
data%>%
  group_by(Continente)%>%
  summarise(media=mean(Puntaje))
```

Podemos realizar la misma operaci√≥n con la mediana

```{r}
data%>%
  group_by(Continente)%>%
  summarise(mediana=median(Puntaje))
```

Y tambi√©n podemos resumir todo en una misma tabla. Este tipo de tabla se llama **Tabla resumen**

```{r}
data%>%
  group_by(Continente)%>%
  summarise(media=mean(Puntaje), mediana=median(Puntaje))
```

#### Ejercicio: Escojan una variable num√©rica que no hayamos utilizado y hallen la mediana y la media de dicha variable, por continente.


<br></br>

</style>

<a href="https://raw.githubusercontent.com/arturomaldonado/PracticasPOL278/main/pd1.Rmd" download="NombreDeTuScript.R">
  <button>Descargar Pr√°ctica Dirigida 1</button>
</a>

<br></br> [Go to page beginning](#beginning)
