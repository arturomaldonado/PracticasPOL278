---
title: "Pr√°ctica dirigida 10"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 1
    theme: cosmo
    highlight: textmate
    always_allow_html: yes
  pdf_document:
    toc: yes
    toc_depth: '1'
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

# **Regresi√≥n linea m√∫ltiple**

Hasta el momento, nos hemos encontrado en el campo del an√°lisis bivariado. Sin embargo, en el mundo social, dif√≠cilmente se pueden explicar los fen√≥menos de inter√©s con una sola variable. Incluso si nos interesa evaluar el efecto de un a variable en espec√≠fico sobre un fen√≥meno de estudio, hay muchos otros factores que podr√≠an influir en aquello que nos interesa explorar. Por ello, necesitamos recurrir al **an√°lisis multivariado** y conocer el concepto de **control estad√≠stico**. 

El control estad√≠stico nos permite ‚Äúeliminar‚Äù explicaciones alternativas, en tanto se aisla el efecto de otras variables. La idea es:

* Evaluar si la asociaci√≥n entre X - Y permanece si se remueve el efecto de otra variable, es decir, si se controla por una tercera variable.

* Se analiza la relaci√≥n entre X - Y para valores similares o iguales de una variable Z. De esta manera se elimina la influencia de Z en la relaci√≥n entre X - Y. Es un paso en el establecimiento de X -> Y.

* Si la relaci√≥n entre X - Y desaparece cuando se controla por Z, se dice que la relaci√≥n era esp√∫rea.

Sobre la regresi√≥n lineal m√∫ltiple: 

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd12_diap1.png") 
```

------------------------------------------------------------------------

Seguiremos los siguientes pasos para el an√°lisis: 

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd12_diap2.png") 
```

# Aplicaci√≥n pr√°ctica

## **Factores que determinan el tipo de cambio nominal (TC_NOMINAL)**

Conocer el tipo de cambio es muy importante para la econom√≠a tanto nacional como internacional. Para ello, observaremos los factores que influyen en dicha denominaci√≥n.

Los datos han sido extra√≠dos de la p√°gina web del Banco Central de Reserva (BCR): "https://estadisticas.bcrp.gob.pe/estadisticas/series/api/PD04645PD/csv/2019-6-10/2024-6-10" y han sido limpiados para este ejercicio.

A partir de la informaci√≥n recolectada se ha creado una base de datos llamada "data".

```{r}
library(rio)
data=import("base_bcr.csv")
names(data)
```

**No olviden el an√°lisis descriptivo antes de hacer los modelos.**

## **Modelo 1**

```{r}
library(tidyverse)

M1 <- lm(TC_NOMINAL ~ ORO, data = data)
summary(M1)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es < 0.05 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n. 

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 m√∫ltiple**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Multiple R-squared, por ser un modelo lineal simple en este caso).

En nuestro modelo, este arroj√≥ el valor de 0.174, por lo que podemos concluir que el modelo explica aproximadamente el 17.4% (0.174\*100) de la variabilidad en el acceso a la informaci√≥n (variable dependiente). En otras palabras, este valor alto de R cuadrado ajustado indica que el modelo se ajusta muy bien a los datos y hace un buen trabajo al explicar la relaci√≥n entre las variables independientes (oro) y la variable dependiente (tipo de cambio nominal). Sin embargo, el valor del R cuadrado ajustado no te dice nada sobre la significancia estad√≠stica de las variables individuales, ni sobre la causalidad. Por ello analizaremos tambi√©n las variables de forma independiente en el siguiente paso.

*Recordemos que el R cuadrado puede tomar valores entre 0 y 1. Un R cuadrado de 1 indica que el modelo explica toda la variabilidad de la variable Y. Un R cuadrado de 0 indica que el modelo no explica nada de la variabilidad de la variable Y.*

### **¬øLas variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Nos damos cuenta que *no todas* las variables independientes tienen un p-value \<0.05, es el caso de: participaci√≥nDigital y Servicios_Online

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

Podemos obtener extraer los coeficientes del modelo: 

*No olvidar identificar el signo de cada coeficiente, este tendr√° repercusi√≥n en la ecuaci√≥n y su futura aplicaci√≥n*

```{r}
M1$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = 2.89+ \text{ORO} \times (-0.00044) 
$$

¬øQu√© sucede si a√±ado otras variables independientes al modelo 1? Veamos un segundo modelo üëÄ .

## **Modelo 2**

```{r}
library(dplyr)
library(ggplot2)

M2 <- lm(TC_NOMINAL ~ ORO + PETROLEO, data = data)
summary(M2)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es **<0.05**, entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n. 

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamor el R2 (Adjusted R-squared).

En nuestro modelo, este arroj√≥ el valor de 0.408, por lo que podemos concluir mi modelo explica aproximadamente el 40.8% (0.408\*100) de la variabilidad en el tipo de cambio nominal (variable dependiente). 

### **¬øLas variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   *Todas* las variables independientes aportan al modelo.

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

```{r}
M2$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = 2.85541 + \text{ORO} \times (0.00026) + \text{PETROLEO} \times (0.00518) 
$$

Mi modelo ha mejorado?

Bastante: mientras que el modelo 1 explicaba un 17.4%, el modelo 2 explica un 40.8% de la variabilidad del tipo de cambio nominal. 

## **Modelo 3**

Podemos a√±adir el peso de las reservas internacionales (variable RESERVA_INT) del pa√≠s en la influencia del tipo de cambio.

```{r}
M3 <- lm(TC_NOMINAL ~ ORO + PETROLEO + RESERVA_INT, data = data)
summary(M3)
```

## **Interpretamos üòé**

### **¬øEl modelo es v√°lido?**

Establezcamos nuestras hip√≥tesis:

-   H0: El modelo de regresi√≥n no es v√°lido
-   H1: El modelo de regresi√≥n es v√°lido (variable X aporta al modelo)

Luego nos fijamos en el **p-value** Como el p valor es <0.065 entonces podemos afirmar que hay suficiente evidencia para rechazar la H0, por lo que concluimos que el modelo s√≠ es v√°lido como modelo de predicci√≥n.

### **¬øQu√© tanto explica el modelo?**

Observamos el **R2 ajustado**.

Analizar cu√°nto de la variabilidad de la variable dependiente (y) es explicada por las variables independientes elegidas, para ello revisamos el R2 (Adjusted R-squared).

En nuestro modelo, este arroj√≥ el valor de 0.53, por lo que podemos concluir el modelo explica aproximadamente el 53% de la variabilidad en el tipo de cambio nominal (variable dependiente).

### **¬øLas variables aportan al modelo?**

Revisamos **p-value** por cada variable independiente.

-   Esperamos obtener un p-value \<0.05.
-   Esta vez todas las variables **s√≠ aportan** al modelo. Sin embargo, hay que notar que la variable "ORO" casi se acerca al 0.05.

### **¬øCu√°les son los coeficientes de la ecuaci√≥n?**

Coeficientes:

```{r}
M3$coefficients
```

De esa manera puedo hallar la ecuaci√≥n:

$$
Y = 1.284310 + \text{ORO} \times (0.000041) + \text{PETROLEO} \times (0.004226) + \text{RESERVA_INT} \times (-0.000028)
$$ 

## **Ejercicio**

Crea un nuevo modelo a√±adiendo al rendimiento de bonos internacionales (variable RENDIMIENTO_BONO) e interpreta los resultados.