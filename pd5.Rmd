---
title: "Pr√°ctica dirigida 5"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 3
    theme: cosmo
    highlight: textmate
    always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estad√≠stica para el an√°lisis pol√≠tico 1 \| Semestre 2024 - 1 <br>

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

# **Intervalos de confianza para la media**

FALTA:Contextualizar la importancia de analizar temas relacionados con la criminalidad y eficacia de la polic√≠a. 
```{=html}
<style>
.custom-text {
  color: #00688B;
  font-family: Helvetica, sans-serif;
  text-align: center;
  font-weight: bold;
  font-size: 22px;
}
</style>
```
::: custom-text
¬øExiste diferencia de percepciones sobre la calidad del servicio de la PNP en las distintas categor√≠as de estratos y regiones en el 2023? ü§î
:::

FALTA:colocar info de la base de datos

Llamemos a los paquetes

```{r}
library(rio)
library(lsr)
library(dplyr)
library(ggplot2)
```


Importemos la base de datos

```{r}
data=import("ENAPRES_2023.xlsx")
```

| Nombre de variable |                                                                Etiqueta                                                                |
|:-------------:|:-------------------------------------------------------:|
|      vigilancia    | ¬øC√≥mo califica usted la vigilancia de la Polic√≠a Nacional del Per√∫? 1:Muy mala, 2:Mala, 3:Buena, 4:Muy buena |
|      confianza_pnp | En cuanto a la seguridad ciudadana; ¬øqu√© tanta confianza le inspira la Polic√≠a Nacional del Per√∫? 1:Nada, 2:Poca, 3:Suficiente, 4:Bastante|
|      comisaria     | En los √∫ltimos 12 meses, ¬øc√≥mo califica usted el trabajo que ha realizado la comisar√≠a de su zona o barrio? |
|      atencion      | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: atender prontamente cuando ocurre un delito? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno|
|      seguridad     | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: mantener la seguridad y tranquilidad p√∫blica? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno|
|      info          | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: informar a la comunidad sobre la prevenci√≥n del delito? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno| 
|      trato_igual   | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: tratar a las personas sin distinci√≥n alguna? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno|
|      ESTRATO       | Estrato sociodemogr√°fico 1:A, 2:B, 3:C, 4:D, 5:E |
|      REGIONNATU    | Regi√≥n Natural 1:Costa, 2: Sierra, 3: Selva |



```{r}
summary(data)
```

Revisemos la bd

```{r, include=TRUE, eval=FALSE}
str(data)
names(data)
```

## 1. ¬øC√≥mo defino calidad del servicio de la PNP?

**Indicador proxy**

**Indicador aditivo**


| Nombre de variable |                                                                Etiqueta                                                                |
|:-------------:|:-------------------------------------------------------:|
|      vigilancia    | ¬øC√≥mo califica usted la vigilancia de la Polic√≠a Nacional del Per√∫? 1:Muy mala, 2:Mala, 3:Buena, 4:Muy buena |
|      confianza_pnp | En cuanto a la seguridad ciudadana; ¬øqu√© tanta confianza le inspira la Polic√≠a Nacional del Per√∫? 1:Nada, 2:Poca, 3:Suficiente, 4:Bastante|
|      comisaria     | En los √∫ltimos 12 meses, ¬øc√≥mo califica usted el trabajo que ha realizado la comisar√≠a de su zona o barrio? |
|      atencion      | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: atender prontamente cuando ocurre un delito? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno|
|      seguridad     | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: mantener la seguridad y tranquilidad p√∫blica? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno|
|      info          | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: informar a la comunidad sobre la prevenci√≥n del delito? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno| 
|      trato_igual   | ¬øC√≥mo califica usted el desempe√±o de la Polic√≠a Nacional del Per√∫ en relaci√≥n a: tratar a las personas sin distinci√≥n alguna? 1:Muy malo, 2:Malo, 3:Bueno, 4:Muy bueno|
|      ESTRATO       | Estrato sociodemogr√°fico 1:A, 2:B, 3:C, 4:D, 5:E |
|      REGIONNATU    | Regi√≥n Natural 1:Costa, 2: Sierra, 3: Selva |

### Recordemos los pasos para construir un indicador:

1.  Verificar que las variables correspondan al concepto.
2.  Revisar el sentido de las categor√≠as en el cuestionario/diccionario
3.  Si las categor√≠as est√°n en el correcto sentido, proceder a sumarlas; si no lo est√°n, proceder a recodificarlas para luego sumar. **Recuerda que para sumarlas deben ser variables tipo num√©ricas.**
4.  Realizar suma de las variables a analizar
5.  Aplicar la funci√≥n rescale con el rango espec√≠fico

Ya hab√≠amos revisado previamente que las variables si est√°n como num√©ricas.

```{r}
library(tidyverse)

data=data%>% 
   mutate(suma=(confianza_pnp+comisaria+atencion+seguridad+info+trato_igual+vigilancia))
```


```{r}
summary(data$suma)
```

Creamos el indicador
```{r}
library(scales)
data=data%>% 
  mutate(indicador = rescale(suma, to = c(0, 100)))
```

```{r}
summary(data$indicador)
```

## 2. ¬øCu√°l es la media de la calidad del servicio de la PNP a una certeza del 95%?

```{r}
ic_media = ciMean(data$indicador,na.rm = TRUE)
ic_media
```

Nuestra media poblacional se encuentra entre 4.9 y 5. Esto quiere decir que tenemos una certeza del 95% de que el valor poblacional de la **percepci√≥n de facilidad de labor docente** se encuentra entre 4.9 y 5. Lo que se encuentra muy cercano al punto medio del indicador (5).


## 3.¬øExiste diferencia de medias en cuanto a la percepci√≥n de la calidad de la PNP entre estratos econ√≥micos?
```{r}
data = data %>%
 mutate(ESTRATO = factor(ESTRATO, levels = 1:5, labels = c("A","B","C","D","E"), ordered = TRUE))
```

```{r}
icmedia_estrato = data%>%
  group_by(ESTRATO)%>%
  summarise(Media = mean(indicador, na.rm=T),
            min = ciMean(indicador, na.rm=T)[1],
            max = ciMean(indicador, na.rm=T)[2])

icmedia_estrato
```
```{r}
library(ggplot2)
ggplot(icmedia_estrato, aes(x = ESTRATO, y=Media)) +
  geom_errorbar(aes(ymin=min, ymax=max), width = 0.2)+
   geom_text(aes(label=paste(round(Media, 2))), size=4)+
  xlab("Estrato socioecon√≥mico") + ylab("Promedio de percepci√≥n de la \n calidad de la PNP")+
  ylim(50, 53.5) 
```

## 4.¬øExiste diferencia de medias en cuanto a la percepci√≥n de la calidad de la PNP entre regiones naturales?

```{r}
data = data %>%
 mutate(REGIONNATU = factor(REGIONNATU, levels = 1:3, labels = c("Costa","Sierra","Selva"), ordered = TRUE))
```

```{r}
icmedia_region = data%>%
  group_by(REGIONNATU)%>%
  summarise(Media = mean(indicador, na.rm=T),
            min = ciMean(indicador, na.rm=T)[1],
            max = ciMean(indicador, na.rm=T)[2])

icmedia_region
```

```{r}
ggplot(icmedia_region, aes(x = REGIONNATU, y=Media)) +
  geom_errorbar(aes(ymin=min, ymax=max), width = 0.2)+
   geom_text(aes(label=paste(round(Media, 2))), size=4)+
  xlab("Regi√≥n") + ylab("Promedio de percepci√≥n de la \n calidad de la polic√≠a")+
  ylim(50.5, 52.5) 
```

# **Solucionario PC1**


```{r}
library(dplyr)
library(ggplot2)
library(rio)

data <- import("Renamu-PC1.xlsx")
```

Pregunta 1 1.1 Calcula cu√°l es la frecuencia de recojo de residuos s√≥lidos (P40_1) m√°s com√∫n entre los distritos de Lima y Callao, interpreta los resultados y responde a la pregunta ¬øtodos los distritos recogen la basura diariamente?

```{r}
paragrafico <- data %>% 
  mutate(P40_1=factor(P40_1, levels = c(1:4), labels = c("Diaria","Interdiaria","Dos veces por semana","Una vez por semana"))) %>% 
  group_by(P40_1) %>% 
  summarise(Freq=n())
paragrafico
```

1.2 Usa el gr√°fico pertinente para visualizar la frecuencia de recojo de residuos s√≥lidos (P40_1)
```{r}
ggplot(paragrafico, aes(x=P40_1,y=Freq))+
  geom_bar(stat="identity")
```

Pregunta 2 2.1 Calcula los estad√≠sticos descriptivos para la variable que ‚ÄúCantidad promedio diaria de residuos s√≥lidos (basura) en kilogramos‚Äù (P41_1). Interprete los resultados
```{r}
data %>% 
  summarise(media = mean(P41_1),
            mediana = median(P41_1),
            sd = sd(P41_1),
            var = var(P41_1),
            max=max(P41_1),
            min=min(P41_1),
            Q1=quantile(P41_1)[2],
            Q2=quantile(P41_1)[3],
            Q3=quantile(P41_1)[4])
```

2.2 Use el gr√°fico pertinente para visualizar a la variable P41_1, interprete y responda a la pregunta ¬øcu√°l ser√≠a la mejor medida de tendencia central para representar a la variable?
```{r}
ggplot(data,aes(x = P41_1))+
  geom_histogram()
```

2.3 Genere un gr√°fico que muestre los cuartiles de la variable ‚ÄúP41_1‚Äù seg√∫n Zona (Lima, Callao o Lima Provincias). ¬øExisten diferencias entre las zonas? Interprete los resultados

```{r}
ggplot(data, aes(x=Zona, y=P41_1))+
  geom_boxplot()
```



