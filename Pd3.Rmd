---
title: "Pr치ctica dirigida 3"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 1
    theme: cosmo
    highlight: textmate
    always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estad칤stica para el an치lisis pol칤tico 1 \| Semestre 2023 - 2 <br>

# **E-Government Survey 2022: The Future of Digital Government**

La Encuesta de las Naciones Unidas sobre Gobierno Electr칩nico se ha publicado cada dos a침os por el Departamento de Asuntos Econ칩micos y Sociales de las Naciones Unidas desde 2001. La Encuesta eval칰a el estado de desarrollo del gobierno electr칩nico de todos los Estados miembros de las Naciones Unidas y, durante este tiempo, ha establecido un conjunto de datos y an치lisis exhaustivos.

La evaluaci칩n mide el rendimiento del gobierno electr칩nico de los pa칤ses en relaci칩n con los dem치s, en lugar de ser una medici칩n absoluta. Reconoce que cada pa칤s debe decidir el nivel y la extensi칩n de sus iniciativas de gobierno electr칩nico de acuerdo con sus propias prioridades nacionales de desarrollo y para lograr los Objetivos de Desarrollo Sostenible. La Encuesta sirve como una herramienta de referencia y desarrollo para que los pa칤ses aprendan entre s칤, identifiquen 치reas de fortaleza y desaf칤os en el gobierno electr칩nico y moldeen sus pol칤ticas y estrategias. Tambi칠n tiene como objetivo facilitar e informar las discusiones de los 칩rganos intergubernamentales, incluida la Asamblea General de las Naciones Unidas, el Consejo Econ칩mico y Social y el Foro Pol칤tico de Alto Nivel.

```{r,echo=FALSE, out.width="50%",fig.align="center"}
knitr::include_graphics("PD3_egov22.png") 
```

Carguemos la data *egov2022.xlsx*

```{r}
library(tidyverse)#Convocamos el paquete
library(rio)    
data=import("egov2022.xlsx") 
```

-   "Country Name" : Nombre del pa칤s\
-   "E-Government Index" : Puntaje final de la encuesta\
-   "E-Participation Index" :\
-   "Online Service Index" :\
-   "Human Capital Index" :\
-   "Telecommunication Infrastructure Index" :
-   "region" : Continente donde pertenece cada pa칤s

# **1.Recordando el an치lisis descriptivo**

-   **Moda**: Nominales, ordinales y num칠ricas
-   **Mediana**: Ordinales y num칠ricas
-   **Media**: Num칠ricas

Vemos las variables 游븷

```{r}
names(data)
```
Revisamos la estructura de la bd
```{r}
str(data)
```

Podemos ver que casi todas las variables son num칠ricas, excepto la variable *region* que se muestra como texto, pero es categ칩rica. Procedemos a revisar sus niveles y a categorizarla.

```{r}
data %>%
 group_by(region) %>%
  summarize(Freq=n())
```

```{r}
data$region=as.factor(data$region)
str(data) #comprobamos
```

# **2. An치lisis del E-Gov Index**

Revisamos solo la media del E-Egov Index
```{r}
data |>
  summarise(mean(`E-Government Index`))
```

```{r}
data |>
  summarise(M칤nimo=min(`E-Government Index`), 
            Mediana= median(`E-Government Index`), 
            Desviaci칩n=sd(`E-Government Index`),
            Media= mean(`E-Government Index`),
            M치ximo= max(`E-Government Index`))
```

```{r}
library(ggplot2)
data |>
  ggplot(aes(x=`E-Government Index`))+
  geom_histogram(fill = "blue",
    color = "black",
    bins = 30,
    alpha = 0.7)+
  xlab("E-Government Index") +
  ylab("Frecuencia")+
   theme_minimal()
```

```{r}
data |>
ggplot(aes(x=`E-Government Index`))+
  geom_histogram(fill = "blue",
    color = "black",
    bins = 30,
    alpha = 0.7)+
  geom_vline(xintercept = median(data$`E-Government Index`), color = "red")+
  geom_vline(xintercept = mean(data$`E-Government Index`), color = "green")+
  xlab("E-Government Index") +
  ylab("Frecuencia")+
  theme_light()
```

```{r}
data |> 
  ggplot(aes(y=`E-Government Index`))+
  geom_boxplot()+
  ylab("E-Government Index")
```

### Por regiones

쮺u치l es la importancia de analizar por regiones?

```{r}
data |> 
  filter(region =="Africa") |>
  summarise(mean(`E-Government Index`))
```

```{r}
data %>%
 group_by(region) %>%
  summarize(Media=mean(`E-Government Index`)) 
```

```{r}
paraGBarras=data %>%
 group_by(region) %>%
  summarize(Freq=n()) %>%
   mutate(Porcentaje = (Freq / sum(Freq))*100)
```

```{r}
library(ggplot2)

paraGBarras |> 
  ggplot(aes(x=region, y=Porcentaje, fill=region)) + 
geom_bar(stat = "identity") +
   geom_text(aes(label=round(Porcentaje,1)), vjust=1.30, color="black", size=3)+
  theme_minimal()
```

```{r}
library(ggplot2)
library(dplyr)
data |>
  ggplot(aes(x=`E-Government Index`))+
  geom_histogram()+
  facet_wrap(~region)+
  xlab("E-Gov Index")+
  ylab("Frecuencia")
```

```{r}
ggplot(data, aes(x=region, y=`E-Government Index`, color=region)) + 
  geom_boxplot() + 
  geom_jitter(shape=16, position=position_jitter(0.2)) +#para agregar los casos como puntos
  theme_classic()
```
