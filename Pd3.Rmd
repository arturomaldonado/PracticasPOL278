---
title: "Práctica dirigida 3"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 3
    theme: cosmo
    highlight: textmate
    always_allow_html: true
---

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estadística para el análisis político 1 \| Semestre 2024 - 1 <br>

# **1.Intervalos de confianza**

Con este tema, comenzaremos a enfocarnos en la estadística inferencial. El objetivo de esta es determinar una aproximación del parámetro poblacional a partir de la data de una muestra representativa.

Revisemos algunos conceptos:

-   **Estimador puntual:** un número que es nuestra predicción del parámetro

-   **Intervalo de confianza:** un intervalo de números basado en la distribución de la data observada de la muestra dentro de la cual se cree que estaría el parámetro poblacional.

    *IC = estimador puntual +-/margen de error*

-   **Nivel de confianza:** es la probabilidad de que el parámetro se encuentre en ese intervalo.

-   **Margen de error:** mide qué tan precisa es la estimación del parámetro.

-   **Error de muestreo:** diferencia entre el valor calculado de un estadístico y valor real de un parámetro de la población.

```{r,echo=FALSE, out.width="50%",fig.align="center"}
knitr::include_graphics("IC.png") 
```

### Conceptualización e Importancia

-   Los intervalos de confianza ofrecen una manera de estimar, con alta probabilidad, un rango de valores en el que se encuentra el valor poblacional (o parámetro) de una determinada variable.
-   El intervalo de confianza describe la variabilidad entre la medida obtenida en un estudio y la medida real de la población (el valor real).
-   Un intervalo de confianza de 90%/95%/99% nos indica que dentro del rango dado se encuentra el valor real de un parámetro con 90%/95%/99% de certeza.
-   Existe una relación inversa entre la amplitud del IC y el tamaño muestral: mientras más pequeño es el n, más amplio es el IC. A mayor n, el IC es más estrecho.
-   Gracias al IC podemos determinar si la estimación es representativa de la población.

### Sobre el nivel de confianza...

Si tenemos un nivel de confianza de 95%, quiere decir que si realizamos 100 veces el mismo procedimiento de muestreo y calculamos los estadísticos de interés, 95 veces obtendremos los resultados en el intervalo calculado. Los mismo ocurriría si realizamos el cálculo con un 99% de confianza. Al momento de decidir el nivel de confianza debemos tener presente una regla: a mayor nivel de confianza, menor será la precisión ya que el intervalo es más amplio.

#### **La data de hoy: E-Government Survey 2022: The Future of Digital Government**

La Encuesta de las Naciones Unidas sobre Gobierno Electrónico se ha publicado cada dos años por el Departamento de Asuntos Económicos y Sociales de las Naciones Unidas desde 2001. La Encuesta evalúa el estado de desarrollo del gobierno electrónico de todos los Estados miembros de las Naciones Unidas y, durante este tiempo, ha establecido un conjunto de datos y análisis exhaustivos.

La evaluación mide el rendimiento del gobierno electrónico de los países en relación con los demás, en lugar de ser una medición absoluta. Reconoce que cada país debe decidir el nivel y la extensión de sus iniciativas de gobierno electrónico de acuerdo con sus propias prioridades nacionales de desarrollo y para lograr los Objetivos de Desarrollo Sostenible. La Encuesta sirve como una herramienta de referencia y desarrollo para que los países aprendan entre sí, identifiquen áreas de fortaleza y desafíos en el gobierno electrónico y moldeen sus políticas y estrategias. También tiene como objetivo facilitar e informar las discusiones de los órganos intergubernamentales, incluida la Asamblea General de las Naciones Unidas, el Consejo Económico y Social y el Foro Político de Alto Nivel.

```{r,echo=FALSE, out.width="50%",fig.align="center"}
knitr::include_graphics("PD3_egov22.png") 
```

Carguemos la data *egov2022.xlsx*

```{r, warning=F}
library(dplyr) #Para summarise, mutate, group_by...
library(rio) #para importar la data
library(lsr) #para ciMean
library(ggplot2) #para graficar
data=import("egov2022.xlsx") 
```

| Nombre         | Descripción                                                                          |
|--------------------|----------------------------------------------------|
| Pais           | Nombre del país                                                                      |
| E_gov          | Indicador de gobernanza digital (0-100)                                              |
| E_part         | Transparencia y acceso a la información, participación ciudadana en línea (0 - 100)  |
| Online_service | Servicios en línea otorgado por el Estado (0-100)                                    |
| Human_cap      | Miembros del Estado especializados en el tema (0-100)                                |
| Tele_infra     | Índice de capacidad de redes de telecomunicaciones como acceso a internet 5G (0-100) |
| Region         | Continente donde pertenece cada país                                                 |

## Pregunta: ¿Cuál es el estado de la gobernanza digital de los países?

## **1.1 Intervalo de confianza para una proporción**

Tengamos en consideración que para poder hallar el intervalo de confianza para una proporción debemos determinar nuestro caso de éxito. Asimismo, para hallar el intervalo de confianza para una proporción nuestra variable debe ser categórica y debe representar una variable dicotómica; es decir, una variable con solo dos categorías posibles: votó/no votó; sí/no, etc.

Recordemos la fórmula para hallar el intervalo de confianza para una proporción

```{r,echo=FALSE, out.width="50%",fig.align="center"}
knitr::include_graphics("ICprop.png") 
```

Para este ejercicio responderemos a la pregunta:

## ¿Qué proporción de países tienen un nivel de transparencia y participación ciudadana en línea alto?

Para ello, hallaremos el intervalo de confianza para la proporción de países que tienen un nivel de transparencia y participación ciudadana en línea es mayor a 70.

Según el diccionario de datos, la variable que mide la transparencia y acceso a la información, participación ciudadana en línea (E_part) es numérica. Necesitamos crear una nueva variable que sea dicotómica y que tenga como punto de corte 70, la llamaremos "E_part_alto". Es decir, todos los países que tengan un valor en E_gov mayor a 70 será "Alto" y los que no será "No alto".

Lograremos esto con el comando ifelse. Este comando tiene 3 argumentos: condición, valor si se cumple la condición, valor cuando no se cumple la condición. Veamos como se aplica a continuación:

```{r}
data = data %>% 
  mutate(E_part_alto = ifelse(E_part > 70, "Alto","No alto"))
```

Ahora que hemos tenemos una variable dicotómica que indique el nivel de transparencia y participación ciudadana en línea, podemos calcular el intervalo para la proporción de países con ese indicador alto.

Debemos realizar una tabla de frecuencias, y luego de identificar el n del caso de éxito y el total ingresamos los valores en el prop.test.

-   Tabla de frecuencias:

Agrupando por "E_part_alto", realizamos un conteo.

```{r}
  data %>% 
  group_by(E_part_alto) %>% 
  summarise(Freq=n())
```

El número casos de éxito es **36** y el total es **36+145.** Reemplacemos esos valores en el prop.test. Primero indicamos los casos de éxito y luego el total de casos.

```{r}
ic_prop  = prop.test(36,181)
ic_prop #llamamos a ic_prop para visualizar los resultados
```

Esto quiere decir que tenemos un 95% de certeza de que, en la población, el porcentaje de países con un nivel alto de participación ciudadana y transparencia online oscila entre 14.5% y 26.7%.

## **1.2 Intervalo de confianza para una media**

En este caso, responderemos a la pregunta:

## En general, ¿cuál es el promedio del indicador de gobernanza digital de los países?

Para ello, hallaremos el intervalo de confianza para la media de países según el indicador de gobernanza digital. Este indicador va de 0 a 100, donde 0 es el menor puntaje y 100 es mayor puntaje.

```{r}
class(data$E_gov) #Revisemos que nuestra variale esté bien clasificada (que sea numérica)

data %>% 
  summarise(media = mean(E_gov), #Revisemos estadísticas de la variable E_gov
            desv = sd(E_gov),
            min = min(E_gov),
            max = max(E_gov)) 
```

**ciMean**, del paquete **lsr**, es la función que calcula el intervalo de confianza de una media.

```{r}
ic_media = data %>% 
  summarise(media = mean(E_gov, na.rm=T), #con el último argumento indicamos no tomar en consideracion los valores perdidos (NA)
            liminf = ciMean(E_gov, na.rm=T)[1],
            limsup = ciMean(E_gov, na.rm=T)[2])
ic_media
```

Nuestra media poblacional se encuentra entre 55.28 y 62.31. Esto quiere decir que la estimación del intervalo indica que tenemos un 95% de certeza de que el valor poblacional del indicador de gobernanza digital se encuentra entre 55.3 y 62.3.

## **1.3 Intervalo de confianza para una media según grupo**

Veamos un nivel más de análisis:

## ¿El indicador de gobernanza digital es igual en todos los continentes?

```{r}
ic_grupo = data %>% 
  group_by(Region) %>% 
  summarise(Media = mean(E_gov, na.rm=T),
            liminf = ciMean(E_gov, na.rm=T)[1],
            limsup = ciMean(E_gov, na.rm=T)[2]
            )
ic_grupo
```

Según nuestra tabla, podemos afirmar que hay un 95% de probabilidad de que a nivel poblacional, la media del índice de gobierno digital en Europa es mayor al resto de continentes (el intervalo de confianza va entre 81 y 87). Por el contrario, África es el continente con menor índice de gobierno digital de todos los evaluados.

Grafiquemos nuestros resultados.

```{r}

ggplot(ic_grupo, aes(x= Region, y =Media)) +
  geom_errorbar(aes(ymin=liminf, ymax=limsup), width = 0.2)+
   geom_text(aes(label=paste(round(Media, 2))), size=4)+
  xlab("Continente") + ylab("Índice de Gobierno Digital")+
  ylim(20, 100)
```

¿Qué podemos extraer del gráfico?

# Ejercicios:

1.  Halla el intervalo de confianza para la proporción de países que cuentan un puntaje en servicios estatales (Online_service) bajo (menor a 25).

    *Hint:* Usar ifelse, cuando Online_service sea menor a 25 será "Bajo", cuando es mayor o igual será "No bajo".

2.  Crea la variable Region2. Cuando la region sea "Asia", se mantiene como "Asia", todo lo demás (Africa, Americas, Europe, Oceania) será "No Asia". ¿Existe una diferencia en el indicador de infraestructura en telecomunicaciones (Tele_infra) si el país está en Asia.

3.  Realizar un gráfico de barras de error para la pregunta anterior
