---
title: "Pr치ctica dirigida 3"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 4
    theme: cosmo
    highlight: textmate
    always_allow_html: yes
    output: pdf_document
  pdf_document:
    toc: yes
    toc_depth: '4'
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estad칤stica para el an치lisis pol칤tico 1 \| Semestre 2024 - 2 <br>

## **Repaso**

### **E-Government Survey 2022: The Future of Digital Government**

La Encuesta de las Naciones Unidas sobre Gobierno Electr칩nico se ha
publicado cada dos a침os por el Departamento de Asuntos Econ칩micos y
Sociales de las Naciones Unidas desde 2001. La Encuesta eval칰a el estado
de desarrollo del gobierno electr칩nico de todos los Estados miembros de
las Naciones Unidas y, durante este tiempo, ha establecido un conjunto
de datos y an치lisis exhaustivos.

La evaluaci칩n mide el rendimiento del gobierno electr칩nico de los pa칤ses
en relaci칩n con los dem치s, en lugar de ser una medici칩n absoluta.
Reconoce que cada pa칤s debe decidir el nivel y la extensi칩n de sus
iniciativas de gobierno electr칩nico de acuerdo con sus propias
prioridades nacionales de desarrollo y para lograr los Objetivos de
Desarrollo Sostenible. La Encuesta sirve como una herramienta de
referencia y desarrollo para que los pa칤ses aprendan entre s칤,
identifiquen 치reas de fortaleza y desaf칤os en el gobierno electr칩nico y
moldeen sus pol칤ticas y estrategias. Tambi칠n tiene como objetivo
facilitar e informar las discusiones de los 칩rganos
intergubernamentales, incluida la Asamblea General de las Naciones
Unidas, el Consejo Econ칩mico y Social y el Foro Pol칤tico de Alto Nivel.

```{r,echo=FALSE, out.width="50%",fig.align="center"}
knitr::include_graphics("PD3_egov22.png") 
```

Carguemos la data ***egov2022.xlsx***

```{r}
library(dplyr)#Convocamos el paquete
library(rio)    
data=import("egov2022.xlsx") 
```

| Nombre         | Descripci칩n                                                                          |
|-------------------------|------------------------------------------------|
| Pais           | Nombre del pa칤s                                                                      |
| E_gov          | Indicador de gobernanza digital (0-100)                                              |
| E_part         | Transparencia y acceso a la informaci칩n, participaci칩n ciudadana en l칤nea (0 - 100)  |
| Online_service | Servicios en l칤nea otorgado por el Estado (0-100)                                    |
| Human_cap      | Miembros del Estado especializados en el tema (0-100)                                |
| Tele_infra     | 칈ndice de capacidad de redes de telecomunicaciones como acceso a internet 5G (0-100) |
| Alto_teleinfra | 쮼l pa칤s tiene un 칤ndice de infraestructura mayor a 80? Si/No                        |
| Region         | Continente donde pertenece cada pa칤s                                                 |

# **1.Recordando el an치lisis descriptivo**

-   **Moda**: Nominales, ordinales y num칠ricas
-   **Mediana**: Ordinales y num칠ricas
-   **Media**: Num칠ricas

Revisamos la estructura de la base de datos y sus variables

```{r}
str(data)
```

Podemos ver que casi todas las variables son num칠ricas, excepto la
variable *Region* que se muestra como texto, pero es categ칩rica.
Procedemos a revisar sus niveles y a recodificarla como factor. Para
ello usamos el comando as.factor, dentro del par칠ntesis debe ir el
nombre de la variable. Otro comando com칰n para cambiar el tipo de
variable es as.numeric, este nos ayuda a convertir la variable a
num칠rica.

```{r}
data = data %>% 
  mutate(Region = as.factor(Region))
class(data$Region)
```

# **2. Aplicaci칩n en R**

### **Pregunta general: 쮺u치l es el estado de la gobernanza digital de los pa칤ses?**

## 2.1 쯈u칠 nivel de desarrollo de infraestructura en telecomunicaciones es m치s frecuente hallar en los pa칤ses?

-   **쮼l pa칤s tiene un nivel alto de infraestructura en
    telecomunicaciones? (**Alto_teleinfra) : Variable categ칩rica

Realicemos una tabla de frecuencias de la variable:

```{r}
grafico1 = data %>%
  group_by(Alto_teleinfra) %>% 
  summarise(Freq=n()) %>% #Hasta este punto hemos obtenido las frecuencias
  mutate(Porcentaje = (Freq/sum(Freq))*100) #Ahora agregamos la columna con los porcentajes. 
grafico1
```

쯈u칠 nos indica la tabla? En este caso, 쯖u치l ser칤a la moda?

Revisemos en un gr치fico:

```{r}
library(ggplot2)
ggplot(grafico1, aes(x=Alto_teleinfra, y= Porcentaje, fill=Alto_teleinfra))+
  geom_bar(stat = "identity")+ xlab("Alto nivel de infraestructura en telecomunicaciones")+ylab("Porcentaje (%)")
```

Revisemos si esta tendencia se mantiene a nivel regional

```{r}
grafico2 = data %>%
  group_by(Region, Alto_teleinfra) %>% 
  summarise(Freq=n()) %>% 
  mutate(Porcentaje = (Freq/sum(Freq))*100) 

grafico2
```

La 칰nica regi칩n en la que la mayor칤a de los pa칤ses cuenta con un nivel
alto de infraestructura en telecomunicaciones alto es Europa.

```{r}
ggplot(grafico2, aes(x=Alto_teleinfra, y= Porcentaje,fill=Alto_teleinfra))+
  geom_bar(stat = "identity")+ 
  facet_wrap(~Region)+
  xlab("")+
  ylab("Porcentaje (%)") + 
  labs(fill = "쮸lto nivel de \n infraestructura \n en comunicaciones?")
```

## 2.2 쮺u치l es el nivel de gobernanza digital de los pa칤ses?

-   **E-Government Index**: Variable num칠rica

Ahora analicemos las medidas de tendencia central, de dispersi칩n y de
posici칩n. 쯈u칠 podemos comentar de los datos obtenidos?

```{r}
data  %>% 
  summarise(M칤nimo=min(E_gov), 
            Media= mean(E_gov),
            Mediana= median(E_gov), 
            Desviaci칩n=sd(E_gov),
            M치ximo= max(E_gov))
```

-   쮺u치l es el puntaje m치s bajo y el m치ximo? Sabemos que ning칰n pa칤s
    llega a 100 en el indicador de gobernanza digital.

-   쮺u치l es el rango? (*max-min*)

-   **Desviaci칩n est치ndar (*sd*)**: La desviaci칩n est치ndar es una medida
    que nos ayuda a entender cu치nto se separan los n칰meros en un
    conjunto de datos del valor promedio o medio. Podemos traducir ello
    como una forma de medir cu치nto "se dispersan" los n칰meros alrededor
    de un n칰mero central. En este caso, la desviaci칩n es de 23.98 esto
    quiere decir que cada pa칤s se encuentra en promedio a 24 puntos de
    la media.

-   쮿ay mucha variabilidad en los datos?

**Visualizaci칩n**

Histograma de E-Gov

```{r}
  ggplot(data, aes(x=E_gov))+
  geom_histogram(fill = "hotpink2",
    color = "black",
    bins = 30,
    alpha = 0.7)+
  xlab("E-Government Index") +
  ylab("Frecuencia")+
   theme_minimal()
```

Histograma de E-Gov + mediana (rojo) + media (verde)

```{r}
ggplot(data, aes(x=E_gov))+
  geom_histogram(fill = "hotpink2",
    color = "black",
    bins = 50,
    alpha = 0.7)+
  geom_vline(xintercept = median(data$E_gov), color = "grey")+
  geom_vline(xintercept = mean(data$E_gov), color = "steelblue2")+
  xlab("E-Government Index") +
  ylab("Frecuencia")+
  theme_light()
```

**Analicemos las medidas de posici칩n y grafiquemos**

Ya sabemos que la mediana es 59

```{r}
data  %>% 
  summarise(Q1 = quantile(E_gov, 0.25),
            Q3 = quantile(E_gov, 0.75))
```

Generemos el gr치fico que mejor permite ver estas medidas de posici칩n

```{r}
  ggplot(data,aes(y=E_gov))+
  geom_boxplot()+
  ylab("E-Government Index")+
  theme_classic()
```

## 2.3 쮺u치nto var칤a el indicador de gobernanza digital seg칰n regi칩n?

```{r}
data  %>% 
  group_by(Region) %>% 
  summarise(
            Q1 = quantile(E_gov, 0.25),
            Q2 = median(E_gov),
            Q3 = quantile(E_gov, 0.75))
```

Podemos afirmar que Europa cuenta unos niveles m치s altos de gobernanza
digital en comparaci칩n a los otras regiones. Esto considerando que el
75% de sus datos superiores superan el 78.75. Las am칠ricas y Asia
tambi칠n muestran resultados elevados, aunque con mayor dispersi칩n. Caso
contrario al de 츼frica y Ocean칤a, en la que la mayor칤a de pa칤ses no
supera los 50 puntos.

Grafiquemos

```{r}
ggplot(data, aes(x=Region,y=E_gov, color = Region))+
  geom_boxplot()+
  theme_bw()+
  xlab("Indicador de gobernanza digital")

```

El gr치fico facilita la visualizaci칩n de la dispersi칩n de los datos. En
el caso de Europa, se observa poca dispersi칩n debido al peque침o tama침o
de la caja, mientras que 츼frica presenta una mayor dispersi칩n. Adem치s,
se identifican valores at칤picos en las Am칠ricas, Europa y Ocean칤a. Estos
valores corresponden a casos que se encuentran a m치s de 1.5 veces el
rango intercuart칤lico (IQR) por encima o por debajo de los l칤mites de la
caja.

## 2.4 쮺u치l es la situaci칩n en cuanto gobernanza digital de 츼frica?

Practiquemos el uso del comando filter. Recuerda que para usar este
comando necesitamos indicar la variable sobre la cual queremos filtrar y
la condici칩n. Analizaremos que sucede en 츼frica. No olvides que debemos
saber de antemano c칩mo esta escrita la palabra.

Revisemos como est치 escrita

```{r}
levels(data$Region)
```

Ahora si, analicemos solo el caso de Africa

```{r}
data %>% 
  filter(Region=="Africa")%>% 
  summarise(Q1 = quantile(E_gov, 0.25),
            Q3 = quantile(E_gov, 0.75))
```

La ventaja de tidyverse es que se pueden concatenar los comandos. Es as칤
que podemos indicar primero que queremos filtrar, y luego generar el
gr치fico sobre esa tabla filtrada solo para el caso de 치frica.

```{r}
data %>% 
  filter(Region=="Africa")%>% 
  ggplot(aes(y=E_gov))+
  geom_boxplot()+
  ylab("E-Government Index")+
  theme_classic()
```

쮺칩mo ha cambiado el estado de la gobernanza digital en comparaci칩n con
los datos de todos los pa칤ses?

# **3. Ejercicios 游 :**

-   Realizar los estad칤sticos descriptivos del Online Service Index
    (Online_Service).

-   Realizar una muestra de aquellos paises que est치n por encima de la
    media del 칤ndice de infraestructura y telecomunicaciones
    (Tele_infra).

-   Realizar diagrama de cajas del E-Participation Index (E_part) por
    regi칩n.

-   Seg칰n si tiene alto nivel de infraestructura en telecomunicaciones
    (Alto_teleinfra), calcula los cuartiles de la variable Human_cap, y
    luego genera un gr치fico que los muestre.
