---
title: "Práctica dirigida 3"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 1
    theme: cosmo
    highlight: textmate
    always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

<center><img src=" " width="200"/></center>

```{r,echo=FALSE, out.width="30%"}
knitr::include_graphics("logoPUCP.png") 
```



**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 278 - Estadística para el análisis político 1 \| Semestre 2023 - 2 <br>

# **E-Government Survey 2022: The Future of Digital Government**

La Encuesta de las Naciones Unidas sobre Gobierno Electrónico se ha publicado cada dos años por el Departamento de Asuntos Económicos y Sociales de las Naciones Unidas (UN DESA) desde 2001. La Encuesta evalúa el estado de desarrollo del gobierno electrónico de todos los Estados miembros de las Naciones Unidas y, durante este tiempo, ha establecido un conjunto de datos y análisis exhaustivos.

La evaluación mide el rendimiento del gobierno electrónico de los países en relación con los demás, en lugar de ser una medición absoluta. Reconoce que cada país debe decidir el nivel y la extensión de sus iniciativas de gobierno electrónico de acuerdo con sus propias prioridades nacionales de desarrollo y para lograr los Objetivos de Desarrollo Sostenible (ODS). La Encuesta sirve como una herramienta de referencia y desarrollo para que los países aprendan entre sí, identifiquen áreas de fortaleza y desafíos en el gobierno electrónico y moldeen sus políticas y estrategias. También tiene como objetivo facilitar e informar las discusiones de los órganos intergubernamentales, incluida la Asamblea General de las Naciones Unidas, el Consejo Económico y Social y el Foro Político de Alto Nivel.

```{r,echo=FALSE, out.width="30%",fig.align="center"}
knitr::include_graphics("PD3_egov22.png") 
```



Carguemos la data *egov2022.xlsx*


```{r}
library(tidyverse)#Convocamos el paquete
library(rio)    
data=import("egov2022.xlsx") 
```

- "Country Name" : Nombre del país                 
- "E-Government Index" : Puntaje final de la encuesta                
- "E-Participation Index" :            
- "Online Service Index" :                  
- "Human Capital Index" :               
- "Telecommunication Infrastructure Index" :
- "region" : Continente donde pertenece cada país


# **1.Recordando el análisis descriptivo**

- **Moda**: Nominales, ordinales y numéricas
- **Mediana**: Ordinales y numéricas
- **Media**: Numéricas

```{r}
names(data)
```
```{r}
str(data)
```
```{r}
table(data$region)
```


```{r}
data$region=as.factor(data$region)
str(data) #comprobamos
```

```{r}
data %>%
 group_by(region) %>%
  summarize(Freq=n())
```


```{r}
data |>
  summarise(mean(`E-Government Index`))
```

```{r}
data |>
  summarise(Mínimo=min(`E-Government Index`), 
            Mediana= median(`E-Government Index`), 
            Desviación=sd(`E-Government Index`),
            Media= mean(`E-Government Index`),
            Máximo= max(`E-Government Index`))
```

```{r}
library(ggplot2)
data |>
  ggplot(aes(x=`E-Government Index`))+
  geom_histogram(fill = "blue",
    color = "black",
    bins = 30,
    alpha = 0.7)+
  xlab("E-Government Index") +
  ylab("Frecuencia")+
   theme_minimal()
```

```{r}
data |>
ggplot(aes(x=`E-Government Index`))+
  geom_histogram(fill = "blue",
    color = "black",
    bins = 30,
    alpha = 0.7)+
  geom_vline(xintercept = median(data$`E-Government Index`), color = "red")+
  geom_vline(xintercept = mean(data$`E-Government Index`), color = "green")+
  xlab("E-Government Index") +
  ylab("Frecuencia")+
  theme_light()
```

```{r}
data |> 
  ggplot(aes(y=`E-Government Index`))+
  geom_boxplot()+
  ylab("E-Government Index")
```


### Por regiones
¿Cuál es la importancia de analizar por regiones?

```{r}
data |> 
  filter(region =="Africa") |>
  summarise(mean(`E-Government Index`))
```


```{r}
data %>%
 group_by(region) %>%
  summarize(Media=mean(`E-Government Index`)) 
```
```{r}
paraGBarras=data %>%
 group_by(region) %>%
  summarize(Freq=n()) %>%
   mutate(Porcentaje = (Freq / sum(Freq))*100)
```

```{r}
library(ggplot2)

paraGBarras |> 
  ggplot(aes(x=region, y=Porcentaje, fill=region)) + 
geom_bar(stat = "identity") +
   geom_text(aes(label=round(Porcentaje,1)), vjust=1.30, color="black", size=3)+
  theme_minimal()
```
```{r}
library(ggplot2)
library(dplyr)
data |>
  ggplot(aes(x=`E-Government Index`))+
  geom_histogram()+
  facet_wrap(~region)+
  xlab("E-Gov Index")+
  ylab("Frecuencia")
```

```{r}
ggplot(data, aes(x=region, y=`E-Government Index`, color=region)) + 
  geom_boxplot() + 
  geom_jitter(shape=16, position=position_jitter(0.2)) +#para agregar los casos como puntos
  theme_classic()
```
